var __extends = this.__extends || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    __.prototype = b.prototype;
    d.prototype = new __();
};
var Layer = require('./layer');
var Squash = require('./squash');
var _Utils = require('./utils');
var Utils = _Utils.Utils;
var SoftMaxLayer = (function (_super) {
    __extends(SoftMaxLayer, _super);
    function SoftMaxLayer(size, label) {
        _super.call(this, size, label);
        this.optimizable = false;
        for (var n = 0; n < this.list.length; n++) {
            this.list[n].squash = Squash.EXP;
        }
    }
    SoftMaxLayer.prototype.activate = function (input) {
        if (this.currentActivation.length != this.list.length)
            this.currentActivation = new Float64Array(this.list.length);
        var activationIndex = 0;
        var sum = 0;
        if (typeof input != 'undefined') {
            if (input.length != this.size)
                throw "INPUT size and LAYER size must be the same to activate!";
            Utils.softMax(input);
            for (var id in this.list) {
                this.list[id].readIncommingConnections(input[id]);
                sum += this.list[id].activation;
            }
        }
        else {
            for (var id in this.list) {
                this.list[id].readIncommingConnections();
                sum += this.list[id].activation;
            }
        }
        if (isNaN(sum) || sum == Infinity || sum == -Infinity) {
            console.log("Sum se fue al choto.", sum);
        }
        for (var n = 0; n < this.currentActivation.length; n++) {
            var x = this.list[n].activation / sum;
            if (x == Infinity) {
                x = 1;
                console.log('act infinity', this.list[n].activation, sum);
            }
            if (isNaN(x) || x == Infinity || x == -Infinity) {
                console.log("Activacion se fue al choto.", this.list[n].derivative, x, sum);
            }
            this.list[n].activation = this.currentActivation[n] = x;
            this.list[n].derivative = x * (1 - x);
            if (isNaN(this.list[n].derivative)) {
                console.log("Derivada se fue al choto.", this.list[n].derivative, x, sum);
            }
            this.list[n].updateTraces();
        }
        return this.currentActivation;
    };
    SoftMaxLayer.prototype.propagate = function (rate, target) {
        /*if (typeof target != 'undefined') {
            for (var n = 0; n < this.currentActivation.length; n++) {
                this.list[n].derivative =  this.list[n].activation-target[n];
            }
        }*/
        _super.prototype.propagate.call(this, rate, target);
    };
    SoftMaxLayer.NormalizeConnectionWeights = function (layerConnection) {
        var sum = 0;
        for (var c = 0; c < layerConnection.list.length; c++) {
            sum += (layerConnection.list[c].weight = Math.exp(layerConnection.list[c].weight));
        }
        for (var c = 0; c < layerConnection.list.length; c++) {
            layerConnection.list[c].weight /= sum;
        }
    };
    return SoftMaxLayer;
})(Layer.Layer);
exports.SoftMaxLayer = SoftMaxLayer;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9zb2Z0bWF4TGF5ZXIudHMiXSwibmFtZXMiOlsiU29mdE1heExheWVyIiwiU29mdE1heExheWVyLmNvbnN0cnVjdG9yIiwiU29mdE1heExheWVyLmFjdGl2YXRlIiwiU29mdE1heExheWVyLnByb3BhZ2F0ZSIsIlNvZnRNYXhMYXllci5Ob3JtYWxpemVDb25uZWN0aW9uV2VpZ2h0cyJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQ0EsSUFBTyxLQUFLLFdBQVcsU0FBUyxDQUFDLENBQUM7QUFDbEMsSUFBTyxNQUFNLFdBQVcsVUFBVSxDQUFDLENBQUM7QUFFcEMsSUFBTyxNQUFNLFdBQVcsU0FBUyxDQUFDLENBQUM7QUFDbkMsSUFBSSxLQUFLLEdBQUcsTUFBTSxDQUFDLEtBQUssQ0FBQztBQUV6QixJQUFhLFlBQVk7SUFBU0EsVUFBckJBLFlBQVlBLFVBQW9CQTtJQUM1Q0EsU0FEWUEsWUFBWUEsQ0FDWkEsSUFBWUEsRUFBRUEsS0FBY0E7UUFDdkNDLGtCQUFNQSxJQUFJQSxFQUFFQSxLQUFLQSxDQUFDQSxDQUFDQTtRQUVuQkEsSUFBSUEsQ0FBQ0EsV0FBV0EsR0FBR0EsS0FBS0EsQ0FBQ0E7UUFFekJBLEdBQUdBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLElBQUlBLENBQUNBLE1BQU1BLEVBQUVBLENBQUNBLEVBQUVBLEVBQUVBLENBQUNBO1lBQzNDQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxNQUFNQSxHQUFHQSxNQUFNQSxDQUFDQSxHQUFHQSxDQUFDQTtRQUNsQ0EsQ0FBQ0E7SUFDRkEsQ0FBQ0E7SUFFREQsK0JBQVFBLEdBQVJBLFVBQVNBLEtBQThCQTtRQUN0Q0UsRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsaUJBQWlCQSxDQUFDQSxNQUFNQSxJQUFJQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQSxNQUFNQSxDQUFDQTtZQUNyREEsSUFBSUEsQ0FBQ0EsaUJBQWlCQSxHQUFHQSxJQUFJQSxZQUFZQSxDQUFDQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQSxNQUFNQSxDQUFDQSxDQUFDQTtRQUU3REEsSUFBSUEsZUFBZUEsR0FBR0EsQ0FBQ0EsQ0FBQ0E7UUFFeEJBLElBQUlBLEdBQUdBLEdBQUdBLENBQUNBLENBQUNBO1FBRVpBLEVBQUVBLENBQUNBLENBQUNBLE9BQU9BLEtBQUtBLElBQUlBLFdBQVdBLENBQUNBLENBQUNBLENBQUNBO1lBQ2pDQSxFQUFFQSxDQUFDQSxDQUFDQSxLQUFLQSxDQUFDQSxNQUFNQSxJQUFJQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQTtnQkFDN0JBLE1BQU1BLHlEQUF5REEsQ0FBQ0E7WUFFakVBLEtBQUtBLENBQUNBLE9BQU9BLENBQUNBLEtBQUtBLENBQUNBLENBQUNBO1lBRXJCQSxHQUFHQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxFQUFFQSxJQUFJQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQTtnQkFDMUJBLElBQUlBLENBQUNBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBLENBQUNBLHdCQUF3QkEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7Z0JBQ2xEQSxHQUFHQSxJQUFJQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQSxFQUFFQSxDQUFDQSxDQUFDQSxVQUFVQSxDQUFDQTtZQUNqQ0EsQ0FBQ0E7UUFDRkEsQ0FBQ0E7UUFBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0E7WUFDUEEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsRUFBRUEsSUFBSUEsSUFBSUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7Z0JBQzFCQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQSxFQUFFQSxDQUFDQSxDQUFDQSx3QkFBd0JBLEVBQUVBLENBQUNBO2dCQUN6Q0EsR0FBR0EsSUFBSUEsSUFBSUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsVUFBVUEsQ0FBQ0E7WUFDakNBLENBQUNBO1FBQ0ZBLENBQUNBO1FBRURBLEVBQUVBLENBQUFBLENBQUNBLEtBQUtBLENBQUNBLEdBQUdBLENBQUNBLElBQUlBLEdBQUdBLElBQUlBLFFBQVFBLElBQUlBLEdBQUdBLElBQUlBLENBQUNBLFFBQVFBLENBQUNBLENBQUFBLENBQUNBO1lBQ3BEQSxPQUFPQSxDQUFDQSxHQUFHQSxDQUFDQSxzQkFBc0JBLEVBQUVBLEdBQUdBLENBQUNBLENBQUNBO1FBQzNDQSxDQUFDQTtRQUVEQSxHQUFHQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxFQUFFQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxpQkFBaUJBLENBQUNBLE1BQU1BLEVBQUVBLENBQUNBLEVBQUVBLEVBQUVBLENBQUNBO1lBQ3hEQSxJQUFJQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxVQUFVQSxHQUFHQSxHQUFHQSxDQUFDQTtZQUV0Q0EsRUFBRUEsQ0FBQUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsUUFBUUEsQ0FBQ0EsQ0FBQUEsQ0FBQ0E7Z0JBQ2pCQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQTtnQkFDTkEsT0FBT0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsY0FBY0EsRUFBRUEsSUFBSUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsVUFBVUEsRUFBR0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7WUFDNURBLENBQUNBO1lBRURBLEVBQUVBLENBQUNBLENBQUNBLEtBQUtBLENBQUNBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLElBQUlBLFFBQVFBLElBQUlBLENBQUNBLElBQUlBLENBQUNBLFFBQVFBLENBQUNBLENBQUNBLENBQUNBO2dCQUNqREEsT0FBT0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsNkJBQTZCQSxFQUFFQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxVQUFVQSxFQUFFQSxDQUFDQSxFQUFFQSxHQUFHQSxDQUFDQSxDQUFDQTtZQUM3RUEsQ0FBQ0E7WUFFREEsSUFBSUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsVUFBVUEsR0FBR0EsSUFBSUEsQ0FBQ0EsaUJBQWlCQSxDQUFDQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQTtZQUV4REEsSUFBSUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsVUFBVUEsR0FBR0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFFdENBLEVBQUVBLENBQUNBLENBQUNBLEtBQUtBLENBQUNBLElBQUlBLENBQUNBLElBQUlBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLFVBQVVBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO2dCQUNwQ0EsT0FBT0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsMkJBQTJCQSxFQUFFQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxVQUFVQSxFQUFFQSxDQUFDQSxFQUFFQSxHQUFHQSxDQUFDQSxDQUFDQTtZQUMzRUEsQ0FBQ0E7WUFHREEsSUFBSUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsWUFBWUEsRUFBRUEsQ0FBQ0E7UUFDN0JBLENBQUNBO1FBRURBLE1BQU1BLENBQUNBLElBQUlBLENBQUNBLGlCQUFpQkEsQ0FBQ0E7SUFDL0JBLENBQUNBO0lBRURGLGdDQUFTQSxHQUFUQSxVQUFVQSxJQUFZQSxFQUFFQSxNQUErQkE7UUFDdERHLEFBS0FBOzs7O1dBREdBO1FBQ0hBLGdCQUFLQSxDQUFDQSxTQUFTQSxZQUFDQSxJQUFJQSxFQUFFQSxNQUFNQSxDQUFDQSxDQUFDQTtJQUMvQkEsQ0FBQ0E7SUFFTUgsdUNBQTBCQSxHQUFqQ0EsVUFBa0NBLGVBQTRDQTtRQUM3RUksSUFBSUEsR0FBR0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7UUFDWkEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsZUFBZUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsTUFBTUEsRUFBRUEsQ0FBQ0EsRUFBRUEsRUFBRUEsQ0FBQ0E7WUFDdERBLEdBQUdBLElBQUlBLENBQUNBLGVBQWVBLENBQUNBLElBQUlBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLE1BQU1BLEdBQUdBLElBQUlBLENBQUNBLEdBQUdBLENBQUNBLGVBQWVBLENBQUNBLElBQUlBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLE1BQU1BLENBQUNBLENBQUNBLENBQUNBO1FBQ3BGQSxDQUFDQTtRQUNEQSxHQUFHQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxFQUFFQSxDQUFDQSxHQUFHQSxlQUFlQSxDQUFDQSxJQUFJQSxDQUFDQSxNQUFNQSxFQUFFQSxDQUFDQSxFQUFFQSxFQUFFQSxDQUFDQTtZQUN0REEsZUFBZUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsTUFBTUEsSUFBSUEsR0FBR0EsQ0FBQ0E7UUFDdkNBLENBQUNBO0lBQ0ZBLENBQUNBO0lBQ0ZKLG1CQUFDQTtBQUFEQSxDQXJGQSxBQXFGQ0EsRUFyRmlDLEtBQUssQ0FBQyxLQUFLLEVBcUY1QztBQXJGWSxvQkFBWSxHQUFaLFlBcUZaLENBQUEiLCJmaWxlIjoic3JjL3NvZnRtYXhMYXllci5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBTeW5hcHRpYyA9IHJlcXVpcmUoJy4vc3luYXB0aWMnKTtcbmltcG9ydCBMYXllciA9IHJlcXVpcmUoJy4vbGF5ZXInKTtcbmltcG9ydCBTcXVhc2ggPSByZXF1aXJlKCcuL3NxdWFzaCcpO1xuaW1wb3J0IE5ldXJvbiA9IHJlcXVpcmUoJy4vbmV1cm9uJyk7XG5pbXBvcnQgX1V0aWxzID0gcmVxdWlyZSgnLi91dGlscycpO1xudmFyIFV0aWxzID0gX1V0aWxzLlV0aWxzO1xuXG5leHBvcnQgY2xhc3MgU29mdE1heExheWVyIGV4dGVuZHMgTGF5ZXIuTGF5ZXIge1xuXHRjb25zdHJ1Y3RvcihzaXplOiBudW1iZXIsIGxhYmVsPzogc3RyaW5nKSB7XG5cdFx0c3VwZXIoc2l6ZSwgbGFiZWwpO1xuXG5cdFx0dGhpcy5vcHRpbWl6YWJsZSA9IGZhbHNlO1xuXG5cdFx0Zm9yICh2YXIgbiA9IDA7IG4gPCB0aGlzLmxpc3QubGVuZ3RoOyBuKyspIHtcblx0XHRcdHRoaXMubGlzdFtuXS5zcXVhc2ggPSBTcXVhc2guRVhQO1xuXHRcdH1cblx0fVxuXG5cdGFjdGl2YXRlKGlucHV0PzogU3luYXB0aWMuSU51bWVyaWNBcnJheSk6IFN5bmFwdGljLklOdW1lcmljQXJyYXkge1xuXHRcdGlmICh0aGlzLmN1cnJlbnRBY3RpdmF0aW9uLmxlbmd0aCAhPSB0aGlzLmxpc3QubGVuZ3RoKVxuXHRcdFx0dGhpcy5jdXJyZW50QWN0aXZhdGlvbiA9IG5ldyBGbG9hdDY0QXJyYXkodGhpcy5saXN0Lmxlbmd0aCk7XG5cblx0XHR2YXIgYWN0aXZhdGlvbkluZGV4ID0gMDtcblxuXHRcdHZhciBzdW0gPSAwO1xuXG5cdFx0aWYgKHR5cGVvZiBpbnB1dCAhPSAndW5kZWZpbmVkJykge1xuXHRcdFx0aWYgKGlucHV0Lmxlbmd0aCAhPSB0aGlzLnNpemUpXG5cdFx0XHRcdHRocm93IFwiSU5QVVQgc2l6ZSBhbmQgTEFZRVIgc2l6ZSBtdXN0IGJlIHRoZSBzYW1lIHRvIGFjdGl2YXRlIVwiO1xuXG5cdFx0XHRVdGlscy5zb2Z0TWF4KGlucHV0KTtcblxuXHRcdFx0Zm9yICh2YXIgaWQgaW4gdGhpcy5saXN0KSB7XG5cdFx0XHRcdHRoaXMubGlzdFtpZF0ucmVhZEluY29tbWluZ0Nvbm5lY3Rpb25zKGlucHV0W2lkXSk7XG5cdFx0XHRcdHN1bSArPSB0aGlzLmxpc3RbaWRdLmFjdGl2YXRpb247XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdGZvciAodmFyIGlkIGluIHRoaXMubGlzdCkge1xuXHRcdFx0XHR0aGlzLmxpc3RbaWRdLnJlYWRJbmNvbW1pbmdDb25uZWN0aW9ucygpO1xuXHRcdFx0XHRzdW0gKz0gdGhpcy5saXN0W2lkXS5hY3RpdmF0aW9uO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHRpZihpc05hTihzdW0pIHx8IHN1bSA9PSBJbmZpbml0eSB8fCBzdW0gPT0gLUluZmluaXR5KXtcblx0XHRcdFx0Y29uc29sZS5sb2coXCJTdW0gc2UgZnVlIGFsIGNob3RvLlwiLCBzdW0pO1xuXHRcdH1cblxuXHRcdGZvciAodmFyIG4gPSAwOyBuIDwgdGhpcy5jdXJyZW50QWN0aXZhdGlvbi5sZW5ndGg7IG4rKykge1xuXHRcdFx0dmFyIHggPSB0aGlzLmxpc3Rbbl0uYWN0aXZhdGlvbiAvIHN1bTtcblxuXHRcdFx0aWYoeCA9PSBJbmZpbml0eSl7XG5cdFx0XHRcdHggPSAxO1xuXHRcdFx0XHRjb25zb2xlLmxvZygnYWN0IGluZmluaXR5JywgdGhpcy5saXN0W25dLmFjdGl2YXRpb24gLCBzdW0pO1xuXHRcdFx0fVxuXHRcdFxuXHRcdFx0aWYgKGlzTmFOKHgpIHx8IHggPT0gSW5maW5pdHkgfHwgeCA9PSAtSW5maW5pdHkpIHtcblx0XHRcdFx0Y29uc29sZS5sb2coXCJBY3RpdmFjaW9uIHNlIGZ1ZSBhbCBjaG90by5cIiwgdGhpcy5saXN0W25dLmRlcml2YXRpdmUsIHgsIHN1bSk7XG5cdFx0XHR9XG5cblx0XHRcdHRoaXMubGlzdFtuXS5hY3RpdmF0aW9uID0gdGhpcy5jdXJyZW50QWN0aXZhdGlvbltuXSA9IHg7XG5cdFx0XHRcblx0XHRcdHRoaXMubGlzdFtuXS5kZXJpdmF0aXZlID0geCAqICgxIC0geCk7XG5cdFx0XHRcblx0XHRcdGlmIChpc05hTih0aGlzLmxpc3Rbbl0uZGVyaXZhdGl2ZSkpIHtcblx0XHRcdFx0Y29uc29sZS5sb2coXCJEZXJpdmFkYSBzZSBmdWUgYWwgY2hvdG8uXCIsIHRoaXMubGlzdFtuXS5kZXJpdmF0aXZlLCB4LCBzdW0pO1xuXHRcdFx0fVxuXG5cblx0XHRcdHRoaXMubGlzdFtuXS51cGRhdGVUcmFjZXMoKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcy5jdXJyZW50QWN0aXZhdGlvbjtcblx0fVxuXHRcblx0cHJvcGFnYXRlKHJhdGU6IG51bWJlciwgdGFyZ2V0PzogU3luYXB0aWMuSU51bWVyaWNBcnJheSkge1xuXHRcdC8qaWYgKHR5cGVvZiB0YXJnZXQgIT0gJ3VuZGVmaW5lZCcpIHtcblx0XHRcdGZvciAodmFyIG4gPSAwOyBuIDwgdGhpcy5jdXJyZW50QWN0aXZhdGlvbi5sZW5ndGg7IG4rKykge1xuXHRcdFx0XHR0aGlzLmxpc3Rbbl0uZGVyaXZhdGl2ZSA9ICB0aGlzLmxpc3Rbbl0uYWN0aXZhdGlvbi10YXJnZXRbbl07XG5cdFx0XHR9XG5cdFx0fSovXG5cdFx0c3VwZXIucHJvcGFnYXRlKHJhdGUsIHRhcmdldCk7XG5cdH1cblx0XG5cdHN0YXRpYyBOb3JtYWxpemVDb25uZWN0aW9uV2VpZ2h0cyhsYXllckNvbm5lY3Rpb246IExheWVyLkxheWVyLkxheWVyQ29ubmVjdGlvbil7XG5cdFx0dmFyIHN1bSA9IDA7XG5cdFx0Zm9yICh2YXIgYyA9IDA7IGMgPCBsYXllckNvbm5lY3Rpb24ubGlzdC5sZW5ndGg7IGMrKykge1xuXHRcdFx0c3VtICs9IChsYXllckNvbm5lY3Rpb24ubGlzdFtjXS53ZWlnaHQgPSBNYXRoLmV4cChsYXllckNvbm5lY3Rpb24ubGlzdFtjXS53ZWlnaHQpKTtcblx0XHR9XG5cdFx0Zm9yICh2YXIgYyA9IDA7IGMgPCBsYXllckNvbm5lY3Rpb24ubGlzdC5sZW5ndGg7IGMrKykge1xuXHRcdFx0bGF5ZXJDb25uZWN0aW9uLmxpc3RbY10ud2VpZ2h0IC89IHN1bTtcblx0XHR9XG5cdH1cbn0iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=